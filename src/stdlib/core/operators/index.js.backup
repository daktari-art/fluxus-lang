// FILENAME: src/stdlib/core/operators/index.js
// Standard Library Operators Index

import { CoreOperators } from './CoreOperators.js';
import { MathOperators } from './MathOperators.js';
import { StringOperators } from './StringOperators.js';

export const StandardLibrary = {
    core: CoreOperators,
    math: MathOperators,
    string: StringOperators
};

export function getOperator(operatorName, library = 'core') {
    const lib = StandardLibrary[library];
    if (!lib) {
        throw new Error(`Unknown library: ${library}`);
    }

    const operators = lib.getOperators();
    return operators[operatorName];
}

export function executeOperator(operatorName, input, args = [], context = {}, library = 'core') {
    const lib = StandardLibrary[library];
    if (!lib) {
        throw new Error(`Unknown library: ${library}`);
    }

    return lib.executeOperator(operatorName, input, args, context);
}

export function getAllOperators() {
    const allOperators = {};
    
    for (const [libName, libClass] of Object.entries(StandardLibrary)) {
        const operators = libClass.getOperators();
        for (const [opName, opDef] of Object.entries(operators)) {
            allOperators[opName] = {
                ...opDef,
                library: libName
            };
        }
    }
    
    return allOperators;
}

export class OperatorsRegistry {
    constructor() {
        this.operators = getAllOperators();
    }
    
    getOperator(name, library = 'core') {
        return getOperator(name, library);
    }
    
    executeOperator(name, input, args = [], context = {}, library = 'core') {
        return executeOperator(name, input, args, context, library);
    }
    
    getAllOperators() {
        return getAllOperators();
    }
    
    generateDocumentation() {
        const operators = getAllOperators();
        const categories = {};
        for (const [name, def] of Object.entries(operators)) {
            const lib = def.library || 'core';
            if (!categories[lib]) categories[lib] = [];
            categories[lib].push({name, type: def.type, description: def.description});
        }
        return categories;
    }
}

export default StandardLibrary;
